var D=(_,o,a)=>new Promise((e,r)=>{var h=n=>{try{i(a.next(n))}catch(c){r(c)}},p=n=>{try{i(a.throw(n))}catch(c){r(c)}},i=n=>n.done?e(n.value):Promise.resolve(n.value).then(h,p);i((a=a.apply(_,o)).next())});import{_ as E,r as T,o as S,D as b,h as l,i as g,d as V,e as d,w as m,l as f,j as w,q as B,s as y,H as C,v as M,F as N,M as O,m as R}from"./index-ed9c130b.js";import{u as F}from"./usePagination-86ed5fbd.js";import K from"./DictTypeEditDialog-f66f46fd.js";import"./tinymce-87fd2522.js";import"./echarts-c0f2d21b.js";import"./useModal-eccda7d1.js";import"./useForm-bc32d484.js";const L={name:"DictTypeTree",components:{DictTypeEditDialog:K},emits:["select"],setup(_,{emit:o}){const{loading:a,list:e}=F(),r=T([]),h=T(""),p=T();S(()=>{i()});function i(){return D(this,null,function*(){a.value=!0;const{code:s,data:u}=yield b.system.getDictTypeList().catch(()=>{a.value=!1});if(a.value=!1,s===200){const{rows:k}=u;e.value=k}})}function n(s,{node:u}){s.length&&(r.value=s,v(u))}function c(){O.confirm({title:"删除提示",content:"确认删除？",onOk:()=>D(this,null,function*(){R.info("点击了删除")})})}function v(s){o("select",s)}return{searchValue:h,dictTypeEditDialogRef:p,selectedKeys:r,list:e,loading:a,handleSelect:n,handleDelete:c}}},j={class:"tree-row"},q={class:"tree-row__name"},H={key:0},I={class:"color-error"},P={key:1},U={class:"tree-row__code"};function z(_,o,a,e,r,h){const p=l("a-input-search"),i=l("icon-plus-outlined"),n=l("icon-edit-outlined"),c=l("icon-delete-outlined"),v=l("a-space"),s=l("a-tree"),u=l("a-card"),k=l("dict-type-edit-dialog");return g(),V(N,null,[d(u,{bordered:!1,type:"flex"},{title:m(()=>[d(p,{value:e.searchValue,"onUpdate:value":o[0]||(o[0]=t=>e.searchValue=t),"allow-clear":"",placeholder:"请输入关键词搜索"},null,8,["value"])]),actions:m(()=>[f("span",{onClick:o[1]||(o[1]=t=>_.$refs.dictTypeEditDialogRef.handleCreate())},[d(i),w(" 新建分类 ")])]),default:m(()=>[e.loading?M("",!0):(g(),B(s,{key:0,"selected-keys":e.selectedKeys,"tree-data":e.list,"field-names":{title:"name",children:"children",key:"key"},"default-expand-all":"","block-node":"",onSelect:e.handleSelect},{title:m(t=>[f("div",j,[f("div",q,[t.name.indexOf(e.searchValue)>-1?(g(),V("span",H,[w(y(t.name.substr(0,t.name.indexOf(e.searchValue)))+" ",1),f("span",I,y(e.searchValue),1),w(" "+y(t.name.substr(t.name.indexOf(e.searchValue)+e.searchValue.length)),1)])):(g(),V("span",P,y(t.name),1))]),f("div",U,y(t.code),1),d(v,{class:"tree-row__actions",onClick:o[2]||(o[2]=C(()=>{},["stop"]))},{default:m(()=>[d(n,{onClick:C(x=>_.$refs.dictTypeEditDialogRef.handleEdit(t),["stop"])},null,8,["onClick"]),d(c,{onClick:x=>e.handleDelete(t)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["selected-keys","tree-data","onSelect"]))]),_:1}),d(k,{ref:"dictTypeEditDialogRef"},null,512)],64)}const $=E(L,[["render",z],["__scopeId","data-v-777de4d8"]]);export{$ as default};
