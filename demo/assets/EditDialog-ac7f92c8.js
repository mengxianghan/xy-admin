var B=Object.defineProperty;var k=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var x=(d,a,o)=>a in d?B(d,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):d[a]=o,w=(d,a)=>{for(var o in a||(a={}))L.call(a,o)&&x(d,o,a[o]);if(k)for(var o of k(a))M.call(a,o)&&x(d,o,a[o]);return d};var y=(d,a,o)=>new Promise((e,s)=>{var v=r=>{try{n(o.next(r))}catch(m){s(m)}},f=r=>{try{n(o.throw(r))}catch(m){s(m)}},n=r=>r.done?e(r.value):Promise.resolve(r.value).then(v,f);n((o=o.apply(d,a)).next())});import{u as R}from"./useModal-5ff77b06.js";import{u as A}from"./useForm-c124bf97.js";import{_ as N,r as U,h as u,i as C,q as T,w as i,e as t,d as V,F as j,v as z,x as G,D as H}from"./index-f770ad8c.js";import"./tinymce-87fd2522.js";import"./echarts-c0f2d21b.js";const I={name:"Edit",emits:["ok"],setup(d,{emit:a}){const{modal:o,showModal:e,hideModal:s,showLoading:v,hideLoading:f}=R(),{formRecord:n,formState:r,formRef:m,rules:c,resetForm:S}=A(),p=U(!1),l=U("取消");c.value={role:{required:!0,message:"请选择所属上级"},name:{required:!0,message:"请输入名称"},alias:{required:!0,message:"请输入别名"},sort:{required:!0,message:"请输入排序"}};function q(){e({type:"create",title:"新建菜单"})}function F(_){e({type:"edit",title:"编辑菜单"}),r.value=G(_),n.value=_}function h(){m.value.validateFields().then(_=>y(this,null,function*(){var g;v();const O=w({id:(g=r.value)==null?void 0:g.id},_);let b=null;b=yield H.common.saveData(O).catch(()=>{f()}),f(),(b==null?void 0:b.code)===200&&(s(),a("ok"))})).catch(()=>{f()})}function D(){s()}function E(){S(),p.value=!1,l.value="取消",f()}return{modal:o,cancelText:l,formRef:m,formState:r,rules:c,disabled:p,handleCreate:q,handleEdit:F,handleOk:h,handleCancel:D,onAfterClose:E}}};function J(d,a,o,e,s,v){const f=u("a-tree-select"),n=u("a-form-item"),r=u("a-radio-group"),m=u("a-input"),c=u("a-switch"),S=u("a-form"),p=u("a-modal");return C(),T(p,{visible:e.modal.visible,title:e.modal.title,width:640,"confirm-loading":e.modal.confirmLoading,"after-close":e.onAfterClose,"ok-button-props":{style:{display:e.disabled?"none":""}},"cancel-text":e.cancelText,onOk:e.handleOk,onCancel:e.handleCancel},{default:i(()=>[t(S,{ref:"formRef",model:e.formState,rules:e.rules,"label-col":{style:{width:"80px"}}},{default:i(()=>[t(n,{label:"所属上级"},{default:i(()=>[t(f,{value:e.formState.parent_id,"onUpdate:value":a[0]||(a[0]=l=>e.formState.parent_id=l),"tree-default-expand-all":""},null,8,["value"])]),_:1}),t(n,{label:"类型",name:"type"},{default:i(()=>[t(r,{value:e.formState.type,"onUpdate:value":a[1]||(a[1]=l=>e.formState.type=l),options:[{label:"菜单",value:"menu"},{label:"按钮",value:"button"}]},null,8,["value"])]),_:1}),t(n,{label:"名称",name:"name"},{default:i(()=>[t(m,{value:e.formState.name,"onUpdate:value":a[2]||(a[2]=l=>e.formState.name=l)},null,8,["value"])]),_:1}),t(n,{label:"别名",name:"alias",extra:"系统唯一且与内置组件名一致，否则导致缓存失效"},{default:i(()=>[t(m,{value:e.formState.alias,"onUpdate:value":a[3]||(a[3]=l=>e.formState.alias=l)},null,8,["value"])]),_:1}),e.formState.type==="menu"?(C(),V(j,{key:0},[t(n,{label:"跳转方式",name:"type"},{default:i(()=>[t(r,{value:e.formState.target,"onUpdate:value":a[4]||(a[4]=l=>e.formState.target=l),options:[{label:"默认",value:1},{label:"iframe",value:2},{label:"外部链接",value:3}]},null,8,["value"])]),_:1}),t(n,{label:"图标",name:"icon"},{default:i(()=>[t(m,{value:e.formState.icon,"onUpdate:value":a[5]||(a[5]=l=>e.formState.icon=l)},null,8,["value"])]),_:1}),t(n,{label:"路由地址",name:"path"},{default:i(()=>[t(m,{value:e.formState.path,"onUpdate:value":a[6]||(a[6]=l=>e.formState.path=l)},null,8,["value"])]),_:1}),t(n,{label:"模板",name:"tpl"},{default:i(()=>[t(m,{value:e.formState.tpl,"onUpdate:value":a[7]||(a[7]=l=>e.formState.tpl=l)},null,8,["value"])]),_:1}),t(n,{label:"视图地址",name:"view"},{default:i(()=>[t(m,{value:e.formState.view,"onUpdate:value":a[8]||(a[8]=l=>e.formState.view=l)},null,8,["value"])]),_:1}),t(n,{label:"菜单高亮",name:"active",extra:"子节点或详情页需要高亮的上级菜单别名"},{default:i(()=>[t(m,{value:e.formState.active,"onUpdate:value":a[9]||(a[9]=l=>e.formState.active=l)},null,8,["value"])]),_:1}),t(n,{label:"隐藏",name:"is_menu",extra:"不显示在导航中，但依然可以访问，例如详情页"},{default:i(()=>[t(c,{checked:e.formState.is_menu,"onUpdate:checked":a[10]||(a[10]=l=>e.formState.is_menu=l)},null,8,["checked"])]),_:1})],64)):z("",!0)]),_:1},8,["model","rules"])]),_:1},8,["visible","title","confirm-loading","after-close","ok-button-props","cancel-text","onOk","onCancel"])}const Z=N(I,[["render",J]]);export{Z as default};
