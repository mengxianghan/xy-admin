var B=Object.defineProperty,T=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var N=(t,a,o)=>a in t?B(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o,w=(t,a)=>{for(var o in a||(a={}))j.call(a,o)&&N(t,o,a[o]);if(U)for(var o of U(a))z.call(a,o)&&N(t,o,a[o]);return t},R=(t,a)=>T(t,P(a));var y=(t,a,o)=>new Promise((e,c)=>{var v=l=>{try{n(o.next(l))}catch(m){c(m)}},s=l=>{try{n(o.throw(l))}catch(m){c(m)}},n=l=>l.done?e(l.value):Promise.resolve(l.value).then(v,s);n((o=o.apply(t,a)).next())});import{_ as G,r as S,h as f,i as H,l as I,w as u,e as i,s as q,D as O}from"./index.a8948c02.js";import{u as J}from"./useModal.97c00550.js";import{u as K}from"./useForm.049bdf41.js";import"./tinymce.b4091e4a.js";import"./echarts.98d40a9a.js";const Q={name:"Edit",emits:["ok"],setup(t,{emit:a}){const{modal:o,showModal:e,hideModal:c,showLoading:v,hideLoading:s}=J(),{formRecord:n,formState:l,formRef:m,rules:_,formLayout:p,resetForm:r}=K(),h=S(!1),g=S("\u53D6\u6D88"),C=S([]);_.value={avatar:{required:!0,message:"\u8BF7\u4E0A\u4F20\u5934\u50CF"},userName:{required:!0,message:"\u8BF7\u8F93\u5165\u767B\u5F55\u5E10\u53F7"},name:{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D"},role:{required:!0,message:"\u8BF7\u9009\u62E9\u6240\u5C5E\u89D2\u8272"}};function x(){return y(this,null,function*(){const{code:d,data:k}=yield O.system.getUserRoleList().catch(()=>{});d===200&&(C.value=k.rows)})}function V(){e({type:"create",title:"\u65B0\u5EFA\u7528\u6237"}),x()}function D(d){e({type:"edit",title:"\u7F16\u8F91\u7528\u6237"}),l.value=R(w({},q(d)),{role:[]}),n.value=d,x()}function E(d){e({type:"preview",title:"\u67E5\u770B\u7528\u6237"}),l.value=q(d),h.value=!0,g.value="\u5173\u95ED",x()}function F(){m.value.validateFields().then(d=>y(this,null,function*(){var L;v();const k=w({id:(L=l.value)==null?void 0:L.id},d);let b=null;b=yield O.common.saveData(k).catch(()=>{s()}),s(),(b==null?void 0:b.code)===200&&(c(),a("ok"))})).catch(d=>{s()})}function M(){c()}function A(){r(),h.value=!1,g.value="\u53D6\u6D88",s()}return{modal:o,formRef:m,rules:_,formState:l,formLayout:p,disabled:h,cancelText:g,roleList:C,handleCreate:V,handleEdit:D,handlePreview:E,handleOk:F,handleCancel:M,onAfterClose:A}}};function W(t,a,o,e,c,v){const s=f("x-upload-image"),n=f("a-form-item"),l=f("a-input"),m=f("a-cascader"),_=f("a-form"),p=f("a-modal");return H(),I(p,{visible:e.modal.visible,title:e.modal.title,width:480,"confirm-loading":e.modal.confirmLoading,"after-close":e.onAfterClose,"ok-button-props":{style:{display:e.disabled?"none":""}},"cancel-text":e.cancelText,onOk:e.handleOk,onCancel:e.handleCancel},{default:u(()=>[i(_,{model:e.formState,rules:e.rules,ref:"formRef","label-col":{style:{width:"90px"}}},{default:u(()=>[i(n,{label:"\u5934\u50CF",name:"avatar"},{default:u(()=>[i(s,{modelValue:e.formState.avatar,"onUpdate:modelValue":a[0]||(a[0]=r=>e.formState.avatar=r),disabled:e.disabled},null,8,["modelValue","disabled"])]),_:1}),i(n,{label:"\u767B\u5F55\u5E10\u53F7",name:"userName"},{default:u(()=>[i(l,{value:e.formState.userName,"onUpdate:value":a[1]||(a[1]=r=>e.formState.userName=r),disabled:e.disabled},null,8,["value","disabled"])]),_:1}),i(n,{label:"\u59D3\u540D",name:"name"},{default:u(()=>[i(l,{value:e.formState.name,"onUpdate:value":a[2]||(a[2]=r=>e.formState.name=r),disabled:e.disabled},null,8,["value","disabled"])]),_:1}),i(n,{label:"\u6240\u5C5E\u89D2\u8272",name:"role"},{default:u(()=>[i(m,{value:e.formState.role,"onUpdate:value":a[3]||(a[3]=r=>e.formState.role=r),placeholder:"",options:e.roleList,disabled:e.disabled,"field-names":{label:"name",value:"key",children:"children"},multiple:"","max-tag-count":"responsive"},null,8,["value","options","disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","title","confirm-loading","after-close","ok-button-props","cancel-text","onOk","onCancel"])}const oe=G(Q,[["render",W]]);export{oe as default};
