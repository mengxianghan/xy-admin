var I=Object.defineProperty;var b=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var h=(s,e,t)=>e in s?I(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,k=(s,e)=>{for(var t in e||(e={}))q.call(e,t)&&h(s,t,e[t]);if(b)for(var t of b(e))U.call(e,t)&&h(s,t,e[t]);return s};var S=(s,e,t)=>new Promise((a,m)=>{var g=r=>{try{d(t.next(r))}catch(c){m(c)}},p=r=>{try{d(t.throw(r))}catch(c){m(c)}},d=r=>r.done?a(r.value):Promise.resolve(r.value).then(g,p);d((t=t.apply(s,e)).next())});import{_ as E,u as L,a as P,b as B,r as M,c as N,o as V,d as F,e as o,w as n,f as j,g as A,m as O,n as T,t as D,h as i,i as G,j as w,M as H,p as J,k as K,l as y}from"./index-f770ad8c.js";import{u as Q}from"./useForm-c124bf97.js";import"./tinymce-87fd2522.js";import"./echarts-c0f2d21b.js";const W={name:"login",setup(){const{formState:s,formRef:e,rules:t}=Q(),a=L(),m=P(),g=B(),p=j(),d=A(),r=M(!1),c=N(()=>{var l,f;return decodeURIComponent((f=(l=d.query)==null?void 0:l.redirect)!=null?f:"")});t.value={username:{required:!0,message:"请输入用户名"},password:{required:!0,message:"请输入密码"}},V(()=>{m.logout()});function v(){return S(this,null,function*(){e.value.validate().then(l=>S(this,null,function*(){r.value=!0;const{code:f}=yield m.login(k({},l)).catch(()=>{r.value=!1,O.error("登录失败")});r.value=!1,f===200&&(a.complete||(yield a.init()),_())}))})}function x(){const l=g.indexRouter;return l||H.warning({title:"系统提示",content:"没有任何权限，请联系系统管理员",onOk:()=>{window.location.reload()}}),l}function _(){if(c.value)location.href=c.value;else{const l=x();if(!l)return;p.push(l)}T.success({message:"欢迎",description:`${D()}，欢迎回来`})}return{formRef:e,rules:t,loading:r,formState:s,handleLogin:v}}},R=s=>(J("data-v-307c66fb"),s=s(),K(),s),X=R(()=>y("span",{class:"cursor-pointer"},"获取验证码",-1)),Y=R(()=>y("div",{class:"color-secondary"},'扫码后点击"确认"，即可完成登录',-1));function Z(s,e,t,a,m,g){const p=i("icon-user-outlined"),d=i("a-input"),r=i("a-form-item"),c=i("icon-lock-outlined"),v=i("a-button"),x=i("a-form"),_=i("a-tab-pane"),l=i("icon-mobile-outlined"),f=i("x-qr-code"),C=i("a-divider"),z=i("a-tabs");return G(),F("div",null,[o(z,null,{default:n(()=>[o(_,{key:"account",tab:"账号登录"},{default:n(()=>[o(x,{model:a.formState,rules:a.rules,ref:"formRef"},{default:n(()=>[o(r,{name:"username"},{default:n(()=>[o(d,{value:a.formState.username,"onUpdate:value":e[0]||(e[0]=u=>a.formState.username=u),size:"large",placeholder:"admin"},{prefix:n(()=>[o(p)]),_:1},8,["value"])]),_:1}),o(r,{name:"password"},{default:n(()=>[o(d,{value:a.formState.password,"onUpdate:value":e[1]||(e[1]=u=>a.formState.password=u),size:"large",type:"password",placeholder:"123456",onPressEnter:a.handleLogin},{prefix:n(()=>[o(c)]),_:1},8,["value","onPressEnter"])]),_:1}),o(r,null,{default:n(()=>[o(v,{type:"primary",size:"large",block:"",loading:a.loading,onClick:a.handleLogin},{default:n(()=>[w("登录 ")]),_:1},8,["loading","onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),o(_,{key:"phone",tab:"手机号登录"},{default:n(()=>[o(x,{model:a.formState,rules:a.rules,ref:"formRef"},{default:n(()=>[o(r,{name:"username"},{default:n(()=>[o(d,{value:a.formState.username,"onUpdate:value":e[2]||(e[2]=u=>a.formState.username=u),size:"large",placeholder:"手机号码"},{prefix:n(()=>[o(l)]),_:1},8,["value"])]),_:1}),o(r,{name:"msgCode"},{default:n(()=>[o(d,{value:a.formState.password,"onUpdate:value":e[3]||(e[3]=u=>a.formState.password=u),size:"large",placeholder:"短信验证码",onPressEnter:a.handleLogin},{prefix:n(()=>[o(c)]),suffix:n(()=>[X]),_:1},8,["value","onPressEnter"])]),_:1}),o(r,null,{default:n(()=>[o(v,{type:"primary",size:"large",block:"",loading:a.loading,onClick:a.handleLogin},{default:n(()=>[w("登录 ")]),_:1},8,["loading","onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),o(_,{key:"qrcode",tab:"二维码登录",class:"align-center"},{default:n(()=>[o(f,{text:"https://mengxianghan.github.io/xy-admin/demo/",size:240}),o(C,{plain:""},{default:n(()=>[Y]),_:1})]),_:1})]),_:1})])}const te=E(W,[["render",Z],["__scopeId","data-v-307c66fb"]]);export{te as default};
