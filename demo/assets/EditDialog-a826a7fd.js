var A=Object.defineProperty,B=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var U=(t,a,o)=>a in t?A(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o,k=(t,a)=>{for(var o in a||(a={}))P.call(a,o)&&U(t,o,a[o]);if(L)for(var o of L(a))j.call(a,o)&&U(t,o,a[o]);return t},q=(t,a)=>B(t,T(a));var w=(t,a,o)=>new Promise((e,c)=>{var v=l=>{try{r(o.next(l))}catch(s){c(s)}},i=l=>{try{r(o.throw(l))}catch(s){c(s)}},r=l=>l.done?e(l.value):Promise.resolve(l.value).then(v,i);r((o=o.apply(t,a)).next())});import{_ as z,r as y,h as f,i as G,q as H,w as u,e as d,x as N,D as R}from"./index-f770ad8c.js";import{u as I}from"./useModal-5ff77b06.js";import{u as J}from"./useForm-c124bf97.js";import"./tinymce-87fd2522.js";import"./echarts-c0f2d21b.js";const K={name:"Edit",emits:["ok"],setup(t,{emit:a}){const{modal:o,showModal:e,hideModal:c,showLoading:v,hideLoading:i}=I(),{formRecord:r,formState:l,formRef:s,rules:_,resetForm:p}=J(),n=y(!1),g=y("取消"),S=y([]);_.value={avatar:{required:!0,message:"请上传头像"},userName:{required:!0,message:"请输入登录帐号"},name:{required:!0,message:"请输入姓名"},role:{required:!0,message:"请选择所属角色"}};function h(){return w(this,null,function*(){const{code:m,data:x}=yield R.system.getUserRoleList().catch(()=>{});m===200&&(S.value=x.rows)})}function D(){e({type:"create",title:"新建用户"}),h()}function O(m){e({type:"edit",title:"编辑用户"}),l.value=q(k({},N(m)),{role:[]}),r.value=m,h()}function V(m){e({type:"preview",title:"查看用户"}),l.value=N(m),n.value=!0,g.value="关闭",h()}function E(){s.value.validateFields().then(m=>w(this,null,function*(){var C;v();const x=k({id:(C=l.value)==null?void 0:C.id},m);let b=null;b=yield R.common.saveData(x).catch(()=>{i()}),i(),(b==null?void 0:b.code)===200&&(c(),a("ok"))})).catch(()=>{i()})}function F(){c()}function M(){p(),n.value=!1,g.value="取消",i()}return{modal:o,disabled:n,cancelText:g,formRef:s,formState:l,rules:_,roleList:S,handleCreate:D,handleEdit:O,handlePreview:V,handleOk:E,handleCancel:F,onAfterClose:M}}};function Q(t,a,o,e,c,v){const i=f("x-upload-image"),r=f("a-form-item"),l=f("a-input"),s=f("a-cascader"),_=f("a-form"),p=f("a-modal");return G(),H(p,{visible:e.modal.visible,title:e.modal.title,width:480,"confirm-loading":e.modal.confirmLoading,"after-close":e.onAfterClose,"ok-button-props":{style:{display:e.disabled?"none":""}},"cancel-text":e.cancelText,onOk:e.handleOk,onCancel:e.handleCancel},{default:u(()=>[d(_,{ref:"formRef",model:e.formState,rules:e.rules,"label-col":{style:{width:"90px"}}},{default:u(()=>[d(r,{label:"头像",name:"avatar"},{default:u(()=>[d(i,{modelValue:e.formState.avatar,"onUpdate:modelValue":a[0]||(a[0]=n=>e.formState.avatar=n),disabled:e.disabled},null,8,["modelValue","disabled"])]),_:1}),d(r,{label:"登录帐号",name:"userName"},{default:u(()=>[d(l,{value:e.formState.userName,"onUpdate:value":a[1]||(a[1]=n=>e.formState.userName=n),disabled:e.disabled},null,8,["value","disabled"])]),_:1}),d(r,{label:"姓名",name:"name"},{default:u(()=>[d(l,{value:e.formState.name,"onUpdate:value":a[2]||(a[2]=n=>e.formState.name=n),disabled:e.disabled},null,8,["value","disabled"])]),_:1}),d(r,{label:"所属角色",name:"role"},{default:u(()=>[d(s,{value:e.formState.role,"onUpdate:value":a[3]||(a[3]=n=>e.formState.role=n),placeholder:"",multiple:"","max-tag-count":"responsive",options:e.roleList,disabled:e.disabled,"field-names":{label:"name",value:"key",children:"children"}},null,8,["value","options","disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","title","confirm-loading","after-close","ok-button-props","cancel-text","onOk","onCancel"])}const ae=z(K,[["render",Q]]);export{ae as default};
